# ============================================================
# Master Configuration for Telco Churn Prediction SaaS
# ============================================================
# This file centralizes all hyperparameters, paths, and
# settings so nothing is hardcoded in source code.

# --- Project Metadata ---
project:
  name: "Telco Customer Churn Prediction" # Human-readable project name
  version: "1.0.0" # Semantic version of this release
  description: "Advanced churn prediction with explainability, drift monitoring, and next-best-action"

# --- Data Paths ---
data:
  raw_path: "data/raw/telco_churn.csv" # Path to the raw input CSV
  processed_path: "data/processed/" # Directory for cleaned/engineered data
  test_size: 0.2 # Fraction of data reserved for testing
  validation_size: 0.15 # Fraction of training data for validation
  random_state: 42 # Seed for reproducible train/test splits

# --- Feature Engineering ---
features:
  # Numerical columns to apply scaling/transformations
  numerical_columns:
    - "tenure" # Months the customer has been with the company
    - "MonthlyCharges" # Current monthly charge amount
    - "TotalCharges" # Cumulative charges over tenure

  # Categorical columns to encode
  categorical_columns:
    - "gender" # Male / Female
    - "SeniorCitizen" # 0 or 1 flag
    - "Partner" # Yes / No
    - "Dependents" # Yes / No
    - "PhoneService" # Yes / No
    - "MultipleLines" # Yes / No / No phone service
    - "InternetService" # DSL / Fiber optic / No
    - "OnlineSecurity" # Yes / No / No internet service
    - "OnlineBackup" # Yes / No / No internet service
    - "DeviceProtection" # Yes / No / No internet service
    - "TechSupport" # Yes / No / No internet service
    - "StreamingTV" # Yes / No / No internet service
    - "StreamingMovies" # Yes / No / No internet service
    - "Contract" # Month-to-month / One year / Two year
    - "PaperlessBilling" # Yes / No
    - "PaymentMethod" # Electronic check / Mailed check / Bank transfer / Credit card

  # Rolling window sizes (in months) for time-aware aggregates
  rolling_windows: [3, 6, 12] # 3-month, 6-month, 12-month windows

  # Target column
  target: "Churn" # Binary label: Yes / No

# --- Model Training ---
model:
  # Which algorithms to train and compare
  algorithms:
    - "logistic_regression" # Baseline linear model
    - "random_forest" # Ensemble of decision trees
    - "xgboost" # Gradient boosting (XGBoost)
    - "lightgbm" # Light Gradient Boosting Machine

  # XGBoost hyperparameters
  xgboost_params:
    n_estimators: 500 # Number of boosting rounds
    max_depth: 6 # Maximum tree depth
    learning_rate: 0.05 # Step size shrinkage
    subsample: 0.8 # Row sampling ratio per tree
    colsample_bytree: 0.8 # Column sampling ratio per tree
    scale_pos_weight: 3.0 # Weight for minority class (churn)
    eval_metric: "aucpr" # Optimize for PR-AUC
    early_stopping_rounds: 50 # Stop if no improvement for 50 rounds
    random_state: 42 # Reproducibility seed

  # LightGBM hyperparameters
  lightgbm_params:
    n_estimators: 500 # Number of boosting iterations
    max_depth: -1 # No depth limit (leaf-wise growth)
    learning_rate: 0.05 # Step size shrinkage
    num_leaves: 31 # Maximum number of leaves per tree
    subsample: 0.8 # Bagging fraction
    colsample_bytree: 0.8 # Feature fraction
    is_unbalance: true # Auto-handle class imbalance
    metric: "average_precision" # Optimize for PR-AUC
    early_stopping_rounds: 50 # Patience for early stopping
    random_state: 42 # Reproducibility seed

  # Random Forest hyperparameters
  random_forest_params:
    n_estimators: 300 # Number of trees in the forest
    max_depth: 15 # Maximum depth per tree
    min_samples_split: 10 # Minimum samples to split a node
    min_samples_leaf: 5 # Minimum samples in a leaf
    class_weight: "balanced" # Auto-weight classes by frequency
    random_state: 42 # Reproducibility seed

  # Logistic Regression hyperparameters
  logistic_regression_params:
    C: 1.0 # Inverse regularization strength
    penalty: "l2" # L2 (Ridge) regularization
    solver: "lbfgs" # Optimization algorithm
    max_iter: 1000 # Maximum solver iterations
    class_weight: "balanced" # Auto-weight classes by frequency
    random_state: 42 # Reproducibility seed

  # Probability calibration method
  calibration_method: "isotonic" # "sigmoid" (Platt) or "isotonic"

  # Decision threshold optimization
  threshold:
    method: "profit" # "f1", "profit", or "custom"
    retention_cost: 50 # Cost ($) of a retention offer
    avg_customer_value: 500 # Average annual customer value ($)

# --- Evaluation ---
evaluation:
  metrics:
    - "roc_auc" # Area Under ROC Curve
    - "pr_auc" # Area Under Precision-Recall Curve
    - "f1" # F1 Score (harmonic mean of P & R)
    - "precision" # Precision (positive predictive value)
    - "recall" # Recall (sensitivity / true positive rate)
    - "lift_at_10" # Lift in top 10% of predictions
    - "expected_profit" # Profit from optimal threshold
  top_k_percentiles: [5, 10, 20] # Percentiles for lift/recall@k

# --- Monitoring ---
monitoring:
  psi_threshold: 0.2 # Population Stability Index alert threshold
  drift_check_frequency: "weekly" # How often to run drift checks
  performance_decay_threshold: 0.05 # Alert if metric drops by this much

# --- API ---
api:
  host: "0.0.0.0" # Bind address for the API server
  port: 8000 # Port for the API server
  model_path: "models/best_model.joblib" # Path to the serialized best model
  log_predictions: true # Whether to log each prediction

# --- Dashboard ---
dashboard:
  port: 8501 # Port for the Streamlit dashboard
  refresh_interval: 300 # Auto-refresh interval in seconds
